(function(){$("#punchcard").hide()})();
function punchcard_collect_data(){var i=$("#punchcard");i.hide();var b={values:[],max:0,min:0,labels_x:[],labels_y:[],raw_x:[],raw_y:[]};$("tbody td",i).each(function(){var a=$(this);a=parseFloat(a.text(),10);b.values.push(a);b.min=Math.min(a,b.min);b.max=Math.max(a,b.max)});$("tbody th",i).each(function(){var a=$(this),c=a.text();c=c.trim();b.labels_y.push(c);a=a.attr("data-raw");a=a.trim();b.raw_y.push(a)});$("tfoot th",i).each(function(){var a=$(this),c=a.text();c=c.trim();b.labels_x.push(c);a=
a.attr("data-raw");a=a.trim();b.raw_x.push(a)});return b}
function punchcard_draw(i){var b=punchcard_collect_data(),a=window.innerWidth*0.9,c=window.innerHeight*0.8,j=Raphael("chart",a,c),g={font:"10px",stroke:"none",fill:"#666"};a=(a-60)/b.labels_x.length;for(var u=(c-25)/b.labels_y.length,r=Math.round(a/2)-1,d=0,n=b.labels_x.length;d<n;d++){var e=60+a*(d+0.5),k=c-6,l=b.labels_x[d];e=j.text(e,k,l);e.attr(g)}d=0;for(n=b.labels_y.length;d<n;d++){e=30;k=u*(d+0.5);l=b.labels_y[d];e=j.text(e,k,l);e.attr(g)}d=c=0;for(n=b.labels_y.length;d<n;d++){g=0;for(e=b.labels_x.length;g<
e;g++){if(l=(k=b.values[c])&&Math.min(Math.round(Math.sqrt(k/Math.PI)*4),r)){var o=i;o=o.replace("{X}",b.raw_x[g]);o=o.replace("{Y}",b.raw_y[d]);(function(f,p,h,w,x){var s="hsb("+[(1-h/r)*0.5,1,0.75]+")",t=j.circle(f+35+h,p+10,h);t.attr({stroke:"none",fill:s});if(h<6){var m=j.circle(f+35+h,p+10,6);m.attr({stroke:"none",fill:"#000",opacity:0.4});m.hide()}var q=j.text(f+35+h,p+10,w);q.attr({font:"10px",stroke:"none",fill:"#fff"});q.hide();f=j.circle(f+35+h,p+10,r);f.attr({stroke:"none",fill:"#000",
opacity:0});f[0].onmouseover=function(){if(m)m.show();else{var v=Raphael.rgb2hsb(s);v.b=0.5;t.attr("fill",Raphael.hsb2rgb(v).hex)}q.show()};f[0].onmouseout=function(){m?m.hide():t.attr("fill",s);q.hide()};f[0].onclick=function(){location.href=x}})(60+a*(g+0.5)-35-l,u*(d+0.5)-10,l,k,o)}c++}}};
