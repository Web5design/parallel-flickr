var timeout_geo=null;
function photo_geo_edit_meta(h){timeout_geo&&clearTimeout(timeout_geocontext);var e=$("#edit_geo").attr("geo:context"),d={0:"in a place that doesn't matter (not defined)",1:"indoors",2:"outdoors"},a='<div id="modal_geo">';a='<form id="photo_geo_update_context">';a+="<h3>Edit the geo context for this photo</h3>";a+="This photo was taken ";a+='<select id="new_geocontext">';for(i in d){a+='<option value="'+i+'"';if(i==e)a+=' selected="true" disabled="true"';a+=">"+d[i]+"</option>"}a+="</select>";a+=
"&#160;";a+='<input type="submit" value="UPDATE" />';a+="</form>";a+="</div>";a+='<div id="photo_geo_status"></div>';a+='<div id="photo_geo_close"><a href="#" onclick="$.modal.close(); return false;">close</a></div>';$.modal(a);$("#photo_geo_update_context").submit(function(){var c=$("#new_geocontext");c=c.val();if(c==e)alert("Hey! There's nothing to update!");else{$.ajax({url:"/api/",type:"POST",data:{method:"flickr.photos.geo.setContext",photo_id:h,context:c},success:function(b){if(b.stat!="ok")$("#photo_geo_status").html("Ack! There was a problem calling the Flickr API.");
else{$("#edit_geo").attr("geo:context",b.context);var f=d[b.context],g="";if(b.context!=0)g="It was taken "+f;$("#geo_context").html(g);b="<p>Success! The geo context for this photo has been updated and is now <strong>"+f+"</strong>.</p>";b+='<p style="font-style:italic;font-size:small;">This dialog will close itself automagically in a moment...</p>';$("#photo_geo_status").html(b);timeout_geocontext=setTimeout(function(){$.modal.close()},2E3)}}});$("#photo_geo_update_context").hide();$("#photo_geo_status").html("Poking the Flickr API...");
return false}})};
